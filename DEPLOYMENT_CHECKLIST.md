# OceanBase éƒ¨ç½²æ£€æŸ¥æ¸…å•

## âœ… éƒ¨ç½²å‰æ£€æŸ¥

### æ•°æ®åº“å‡†å¤‡

- [ ] OceanBase æ•°æ®åº“è¿è¡Œæ­£å¸¸
- [ ] èƒ½å¤Ÿè¿æ¥åˆ°æ•°æ®åº“
  ```bash
  mysql -h192.168.1.70 -P2883 -uroot@Tianji4_MySQL#Tianji4 -paaAA11__
  ```
- [ ] å·²æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
  ```bash
  source scripts/init-mysql-database.sql
  ```
- [ ] éªŒè¯ 5 ä¸ªè¡¨å·²åˆ›å»º
  ```sql
  SHOW TABLES;
  -- åº”è¯¥çœ‹åˆ°: users, modules, workflows, scenarios, execution_logs
  ```

### ç¯å¢ƒé…ç½®

- [ ] å·²åˆ›å»º .env æ–‡ä»¶
- [ ] é…ç½®äº†æ­£ç¡®çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯
  ```bash
  VITE_SERVICE_PROVIDER=custom
  DB_HOST=192.168.1.70
  DB_PORT=2883
  DB_USER=root@Tianji4_MySQL#Tianji4
  DB_PASSWORD=aaAA11__
  DB_DATABASE=ops_workflow_center
  ```
- [ ] ä¿®æ”¹äº† JWT_SECRET ä¸ºéšæœºå­—ç¬¦ä¸²
- [ ] æµ‹è¯•æ•°æ®åº“è¿æ¥æˆåŠŸ
  ```bash
  mysql -h192.168.1.70 -P2883 -uroot@Tianji4_MySQL#Tianji4 -paaAA11__ -e "USE ops_workflow_center; SELECT COUNT(*) FROM users;"
  ```

### æœåŠ¡å™¨å‡†å¤‡

- [ ] Docker å·²å®‰è£…
- [ ] Docker Compose å·²å®‰è£…
- [ ] æœåŠ¡å™¨æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ï¼ˆè‡³å°‘ 10GBï¼‰
- [ ] æœåŠ¡å™¨æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼ˆè‡³å°‘ 2GBï¼‰

---

## âœ… éƒ¨ç½²è¿‡ç¨‹

### 1. éƒ¨ç½²åº”ç”¨

- [ ] æ‰§è¡Œéƒ¨ç½²è„šæœ¬
  ```bash
  sudo bash docker-deploy.sh
  ```
- [ ] ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé¦–æ¬¡çº¦ 5-10 åˆ†é’Ÿï¼‰
- [ ] æ²¡æœ‰é”™è¯¯ä¿¡æ¯

### 2. éªŒè¯å®¹å™¨

- [ ] å®¹å™¨æ­£åœ¨è¿è¡Œ
  ```bash
  sudo docker-compose ps
  # çŠ¶æ€åº”è¯¥æ˜¯ "Up"
  ```
- [ ] æŸ¥çœ‹å¯åŠ¨æ—¥å¿—æ— é”™è¯¯
  ```bash
  sudo docker-compose logs
  ```
- [ ] èƒ½çœ‹åˆ°æ•°æ®åº“è¿æ¥ä¿¡æ¯
  ```bash
  sudo docker-compose logs | grep "DB_HOST"
  # åº”è¯¥æ˜¾ç¤º: DB_HOST: 192.168.1.70
  ```

### 3. é…ç½®é˜²ç«å¢™

- [ ] å¼€æ”¾å‰ç«¯ç«¯å£ 5173
  ```bash
  sudo firewall-cmd --permanent --add-port=5173/tcp
  ```
- [ ] å¼€æ”¾åç«¯ç«¯å£ 3000
  ```bash
  sudo firewall-cmd --permanent --add-port=3000/tcp
  ```
- [ ] é‡è½½é˜²ç«å¢™
  ```bash
  sudo firewall-cmd --reload
  ```
- [ ] éªŒè¯ç«¯å£å¼€æ”¾
  ```bash
  sudo firewall-cmd --list-ports
  ```

### 4. äº‘æœåŠ¡å™¨å®‰å…¨ç»„ï¼ˆå¦‚é€‚ç”¨ï¼‰

- [ ] åœ¨äº‘æ§åˆ¶å°æ·»åŠ å…¥ç«™è§„åˆ™ï¼šç«¯å£ 5173
- [ ] åœ¨äº‘æ§åˆ¶å°æ·»åŠ å…¥ç«™è§„åˆ™ï¼šç«¯å£ 3000
- [ ] ä¿å­˜å¹¶åº”ç”¨å®‰å…¨ç»„è§„åˆ™

---

## âœ… éƒ¨ç½²åéªŒè¯

### æœåŠ¡æµ‹è¯•

- [ ] åç«¯å¥åº·æ£€æŸ¥é€šè¿‡
  ```bash
  curl http://localhost:3000/health
  # åº”è¯¥è¿”å›: {"status":"ok","timestamp":"..."}
  ```
- [ ] å‰ç«¯é¡µé¢å¯è®¿é—®
  ```bash
  curl http://localhost:5173
  # åº”è¯¥è¿”å› HTML å†…å®¹
  ```
- [ ] ä»å¤–éƒ¨è®¿é—®å‰ç«¯
  ```
  æµè§ˆå™¨æ‰“å¼€: http://æœåŠ¡å™¨IP:5173
  ```

### åŠŸèƒ½æµ‹è¯•

- [ ] èƒ½å¤Ÿæ‰“å¼€æ³¨å†Œé¡µé¢
- [ ] èƒ½å¤Ÿæ³¨å†Œæ–°ç”¨æˆ·
- [ ] æ³¨å†Œåèƒ½çœ‹åˆ°ç”¨æˆ·æ•°æ®å†™å…¥æ•°æ®åº“
  ```bash
  mysql -h192.168.1.70 -P2883 -uroot@Tianji4_MySQL#Tianji4 -paaAA11__ -e "USE ops_workflow_center; SELECT email FROM users;"
  ```
- [ ] èƒ½å¤Ÿç™»å½•ç³»ç»Ÿ
- [ ] ç™»å½•åèƒ½çœ‹åˆ°ä¸»ç•Œé¢
- [ ] èƒ½å¤Ÿåˆ›å»ºå·¥ä½œæµ
- [ ] èƒ½å¤Ÿä¿å­˜åœºæ™¯

### æ•°æ®æŒä¹…åŒ–

- [ ] é‡å¯å®¹å™¨åæ•°æ®ä»ç„¶å­˜åœ¨
  ```bash
  sudo docker-compose restart
  # ç­‰å¾… 30 ç§’
  # å†æ¬¡ç™»å½•ï¼Œæ£€æŸ¥æ•°æ®æ˜¯å¦è¿˜åœ¨
  ```
- [ ] ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ ./uploads/ ç›®å½•
- [ ] æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ ./logs/ ç›®å½•

---

## âœ… æ€§èƒ½å’Œç›‘æ§

### èµ„æºä½¿ç”¨

- [ ] æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
  ```bash
  sudo docker stats ops-workflow-center
  ```
- [ ] CPU ä½¿ç”¨ç‡æ­£å¸¸ï¼ˆ< 50%ï¼‰
- [ ] å†…å­˜ä½¿ç”¨æ­£å¸¸ï¼ˆ< 1GBï¼‰

### æ•°æ®åº“çŠ¶æ€

- [ ] æŸ¥çœ‹æ•°æ®åº“è¿æ¥æ•°
  ```sql
  SHOW PROCESSLIST;
  ```
- [ ] æŸ¥çœ‹è¡¨å¤§å°
  ```sql
  SELECT table_name, table_rows,
  ROUND(((data_length + index_length) / 1024 / 1024), 2) AS size_mb
  FROM information_schema.TABLES
  WHERE table_schema = 'ops_workflow_center';
  ```

### æ—¥å¿—æ£€æŸ¥

- [ ] åº”ç”¨æ—¥å¿—æ­£å¸¸
  ```bash
  tail -f logs/api-out.log
  tail -f logs/frontend-out.log
  ```
- [ ] æ²¡æœ‰é‡å¤çš„é”™è¯¯ä¿¡æ¯
- [ ] æ²¡æœ‰æ•°æ®åº“è¿æ¥é”™è¯¯

---

## âœ… å®‰å…¨é…ç½®

### åŸºç¡€å®‰å…¨

- [ ] ä¿®æ”¹äº†é»˜è®¤çš„ JWT_SECRET
- [ ] æ•°æ®åº“å¯†ç è¶³å¤Ÿå¼ºï¼ˆå»ºè®®ï¼‰
- [ ] é˜²ç«å¢™åªå¼€æ”¾å¿…è¦ç«¯å£
- [ ] äº‘å®‰å…¨ç»„è§„åˆ™å·²é…ç½®ï¼ˆå¦‚é€‚ç”¨ï¼‰

### æ•°æ®åº“å®‰å…¨ï¼ˆæ¨èï¼‰

- [ ] åˆ›å»ºäº†ä¸“ç”¨æ•°æ®åº“ç”¨æˆ·ï¼ˆé rootï¼‰
  ```sql
  CREATE USER 'ops_app'@'%' IDENTIFIED BY 'å¼ºå¯†ç ';
  GRANT SELECT, INSERT, UPDATE, DELETE ON ops_workflow_center.* TO 'ops_app'@'%';
  FLUSH PRIVILEGES;
  ```
- [ ] æ›´æ–° .env ä½¿ç”¨ä¸“ç”¨ç”¨æˆ·
  ```bash
  DB_USER=ops_app@Tianji4_MySQL#Tianji4
  DB_PASSWORD=å¼ºå¯†ç 
  ```
- [ ] é™åˆ¶æ•°æ®åº“è®¿é—®IPï¼ˆå¯é€‰ï¼‰

### å¤‡ä»½ç­–ç•¥

- [ ] è®¾ç½®äº†æ•°æ®åº“å®šæœŸå¤‡ä»½
  ```bash
  # æ·»åŠ åˆ° crontab
  0 2 * * * mysqldump -h192.168.1.70 -P2883 -uroot@Tianji4_MySQL#Tianji4 -paaAA11__ ops_workflow_center > /backup/ops-$(date +\%Y\%m\%d).sql
  ```
- [ ] æµ‹è¯•å¤‡ä»½æ¢å¤æµç¨‹
  ```bash
  mysql -h192.168.1.70 -P2883 -uroot@Tianji4_MySQL#Tianji4 -paaAA11__ ops_workflow_center < backup-20240118.sql
  ```

---

## âœ… æ–‡æ¡£å’Œäº¤æ¥

### æ–‡æ¡£å®Œæ•´æ€§

- [ ] README.md å·²æ›´æ–°
- [ ] OCEANBASE_CONFIG.md å·²é˜…è¯»
- [ ] OCEANBASE_QUICKSTART.md å·²ä¿å­˜
- [ ] éƒ¨ç½²é…ç½®å·²æ–‡æ¡£åŒ–

### å›¢é˜Ÿäº¤æ¥

- [ ] æ•°æ®åº“è¿æ¥ä¿¡æ¯å·²å…±äº«ï¼ˆå®‰å…¨æ¸ é“ï¼‰
- [ ] æœåŠ¡å™¨è®¿é—®æƒé™å·²é…ç½®
- [ ] è¿ç»´äººå‘˜å·²åŸ¹è®­
- [ ] æ•…éšœæ’æŸ¥æµç¨‹å·²å»ºç«‹

---

## ğŸ“ æ•…éšœè”ç³»æ–¹å¼

### å¸¸è§é—®é¢˜å¿«é€Ÿæ’æŸ¥

1. **å®¹å™¨æ— æ³•å¯åŠ¨**
   ```bash
   sudo docker-compose logs
   ```

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   mysql -h192.168.1.70 -P2883 -uroot@Tianji4_MySQL#Tianji4 -p
   telnet 192.168.1.70 2883
   ```

3. **å‰ç«¯æ— æ³•è®¿é—®**
   ```bash
   sudo firewall-cmd --list-all
   curl http://localhost:5173
   ```

4. **æ€§èƒ½é—®é¢˜**
   ```bash
   sudo docker stats
   top
   ```

### æ”¯æŒèµ„æº

- **æ–‡æ¡£**: æŸ¥çœ‹é¡¹ç›®ç›®å½•ä¸­çš„ MD æ–‡ä»¶
- **æ—¥å¿—**: `./logs/` ç›®å½•
- **å¤‡ä»½**: `/backup/` ç›®å½•ï¼ˆå¦‚å·²é…ç½®ï¼‰

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

å¦‚æœä»¥ä¸Šæ‰€æœ‰é¡¹ç›®éƒ½å·²å‹¾é€‰ï¼Œæ­å–œæ‚¨å®Œæˆéƒ¨ç½²ï¼

**è®¿é—®åœ°å€**ï¼š
- å‰ç«¯: `http://æœåŠ¡å™¨IP:5173`
- åç«¯: `http://æœåŠ¡å™¨IP:3000`

**ä¸‹ä¸€æ­¥**ï¼š
1. åˆ›å»ºç®¡ç†å‘˜è´¦å·
2. å¼€å§‹ä½¿ç”¨ç³»ç»Ÿ
3. æ ¹æ®å®é™…éœ€æ±‚é…ç½®å·¥ä½œæµ
4. å®šæœŸæ£€æŸ¥æ—¥å¿—å’Œæ€§èƒ½

---

**éƒ¨ç½²æ—¥æœŸ**: _________________

**éƒ¨ç½²äººå‘˜**: _________________

**éªŒè¯äººå‘˜**: _________________

---

æ›´æ–°æ—¶é—´: 2024-01-18
